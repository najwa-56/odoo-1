<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<template id="report_simplified_tax_invoice_document">
		<t t-call="ksa_zatca_integration.external_layout_seti">
			<t t-foreach="doc" t-as="o">
				<div class="page" style="padding-top:40px;margin-top:-23pt;" >
					<link rel="stylesheet" href="/ksa_zatca_integration/static/src/css/style.css"/>
					<t t-set="company" t-value="res_company"/>
					<div class="font">
						<table style="border:1pt solid grey;width:100%;color:black; margin-top:5pt;" class="table-condensed table-sm">
							<tr>
								<td style="padding:4pt;margin:5pt;font-weight: bold;text-align:center;background-color:#DCDCDC;"><span class="text-right arabic">Simplified Tax Invoice / فاتورة ضريبية مبسطة</span></td> 
							</tr>
					    </table>
					    <br/>
						<div class="row mt32 mb32">
		                <div class="col-9">
							<table style="border:1pt solid grey;width:100%;padding:10pt;margin-top:10pt;color:black;" class="table table-bordered table-sm">
								<tr>
									<td style="font-weight:bold; width:25%;">‫‪Invoice‬‬ ‫‪Number‬‬</td>
									<td style="width:50%; text-align:center;"><span t-field="o.name"/></td>
									<td class="arabic" style="width:25%; text-align:right;">رقم الفاتورة</td>
								</tr>
								<tr>
									<td style="font-weight:bold; width:25%;">‫‪Invoice‬‬ Date</td>
									<td style="width:50%; text-align:center;"><span t-field="o.invoice_date"/></td>
									<td class="arabic" style="width:25%; text-align:right;">تاريخ الفاتورة</td>
								</tr>
								<tr>
									<td style="font-weight:bold; width:25%;">‫‪Due Date</td>
									<td style="width:50%; text-align:center;"><span t-field="o.date_due"/></td>
									<td class="arabic" style="width:25%; text-align:right;">تاريخ الاستحقاق</td>
								</tr>
								<tr>
									<td style="font-weight:bold; width:25%;">‫‪Delivery‬‬ ‫‪Date‬‬</td>
									<td style="width:50%; text-align:center;"><span t-field="o.invoice_date_supply"/></td>
									<td class="arabic" style="width:25%; text-align:right;">تاريخ التسليم</td>
								</tr>
								<tr>
									<td style="font-weight:bold; width:25%;">‫‪Payment Terms‬</td>
									<td style="width:50%; text-align:center;">
									<span t-field="o.invoice_payment_term_id"/>
									</td>
									<td class="arabic" style="width:25%; text-align:right;">فترة الخدمة</td>
								</tr>
							</table>
							<br/>
						</div>
						<div class="col-3" style="margin-top:-5pt; padding-left:25pt;">
							<img t-if="doc.get_qr_code()"
								style="display:block;margin-left:30px;"
								t-att-src="'/report/barcode/?barcode_type=%s&amp;value=%s&amp;width=%s&amp;height=%s'%('QR', doc.get_qr_code(), 130, 130)"/>
			            </div>
			        </div>
			        <br/>
					<table style="border:2pt solid ;width:100%;color:black; margin-top:5pt; color:black;" class="table table-striped" dir="rtl">
						<thead>
							

							<tr style="background-color:#dddddd;color:black; font-weight: bold;">
								<td style="border:2pt solid black;text-align:center;padding:2pt;"><span class="arabic">#</span></td>
								<td width="25%" style="border:2pt solid black;text-align:center;padding:2pt; "><span class="arabic"> الاسم</span></td>
								<t t-if="company.id == 1">
									<td width="25%" style="border:2pt solid black;text-align:center;padding:2pt; "><span class="arabic"> الاسم اللاتنيني</span></td>
								</t>
								<td style="border:2pt solid black;text-align:center;padding:2pt;"><span class="arabic">سعر </span></td>
								<td style="border:2pt solid black;text-align:center;padding:2pt;width:7%"><span class="arabic">الكمية</span></td>
								<td style="border:2pt solid black;text-align:center;padding:2pt;width:7%"><span class="arabic">الوحدة</span></td>
								<!-- <td style="border:2pt solid black;text-align:center;padding:2pt;width:8%"><span class="arabic">نسبة الضريبة</span></td> -->
								<td style="border:2pt solid black;text-align:center;padding:2pt;width:7%"><span class="arabic">معدل الضريبة</span></td>
								<td style="border:2pt solid black;text-align:center; width:10%;padding:2pt"><span class="arabic">مبلغ الضريبة</span></td>
								<td style="border:2pt solid black;text-align:center;padding:2pt;"><span class="arabic">المجموع غير شامل الضريبة</span></td>
								<td style="border:2pt solid black;text-align:center;padding:2pt;"><span class="arabic">المجموع شامل الضريبة</span></td>
							</tr>
						</thead>
					 	<t t-set="tax_total" t-value="0"/>
					 	<t t-set="discount_total" t-value="0"/>
						<tbody class="invoice_tbody">
							<t t-set="count" t-value="1"/>
						 	<tr t-foreach="o.invoice_line_ids" t-as="l">
						 		<t t-set="line_tax_total" t-value="0"/>
					 			<t t-foreach="l.tax_ids" t-as="t">
					 				<t t-set="tax_total" t-value="tax_total + l.price_subtotal* t.amount/100"/>
					 				<t t-set="line_tax_total" t-value="line_tax_total + t.amount"/>
					 			</t>

								 <td style="border:2pt solid black;padding:3pt;text-align:center;background-color:#white; font-weight: bold; ">
									<span class="arabic" t-esc="count"/> 
								</td>

					 			<t t-set="discount_total" t-value="discount_total + ((l.price_unit * l.quantity) - l.price_subtotal)"/>
						 		<td style="border:2pt solid black;padding:3pt;text-align:center">
						 			<span class="arabic" t-field="l.name"/> 
						 		</td>
								<t t-if="company.id == 1">
								 <td style="border:2pt solid black;padding:3pt;text-align:center">
									<span class="arabic" t-field="l.product_arabic"/> 
								</td>
								</t>
						 		<td class="arabic" style="border:2pt solid black;text-align:center;padding:3pt"><span t-field="l.price_unit" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/></td>
						 		<td class="arabic" style="border:2pt solid black;text-align:center;padding:3pt"><span t-esc="'%.2f'%(l.quantity)"/></td>

					 			

						 		
								 <td class="arabic" style="border:2pt solid black;text-align:center;padding:3pt;">
	                                <span t-field="l.uom_name"/>
	                             </td>
			                    
						 		
								 

								<td class="arabic" style="border:2pt solid black;text-align:center;padding:3pt;background-color:#white; font-weight: bold;">
									<t t-if="l.tax_ids">
										<span class="arabic" t-esc="l.tax_ids[0].name"/>
									</t>
			                        
			                    </td>
								<td class="arabic" style="padding:3pt;border:2pt solid black;text-align:center;">
									<t t-set="line_tax_total" t-value="l.price_subtotal*line_tax_total/100"/>
									<span class="arabic" t-esc="line_tax_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
								</td>

								<td class="arabic" style="border:2pt solid black;text-align:center;padding:3pt;background-color:#white; font-weight: bold;">
			                        <span class="arabic" t-field="l.price_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
			                    </td>

								<td class="arabic" style="border:2pt solid black;text-align:center;padding:3pt;background-color:#white; font-weight: bold;">
			                        <span class="arabic" t-field="l.price_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/>
			                    </td>
						 		

								<t t-set="count" t-value="count + 1"/>
						 	</tr>
		               	</tbody>
					</table>
					<br/>


	<table style="border:2pt solid black;width:100%;color:black;margin-top:10px; color:black;" class="table table-bordered table-sm" dir="rtl">
		<thead>
							
			<center>
				<span class="arabic" style="font-weight: bold;text-align:center !important;">المبالغ الإجمالية</span>
			</center>
			<t t-set="discount_before_total" t-value="doc.amount_untaxed + discount_total"/>
			<tr style="border:2pt solid black">
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:right;padding:3pt ; font-weight: bold;"> إجمالي المبلغ قبل  الضريبة</td>
				<td width="30%" style="border:2pt solid black;text-align:center;padding:3pt" class="text-center"><span t-esc="doc.amount_untaxed" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/></td>
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:left;padding:3pt ; font-weight: bold;"> Total Amount Before Tax</td>
				
			</tr>
			
			<tr style="border:2pt solid black">
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:right;padding:3pt ;  font-weight: bold;">إجمالي ضريبة القيمة المضافة</td>
				<td width="30%" style="border:2pt solid black;text-align:center;padding:3pt" class="text-center"><span t-esc="tax_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/></td>
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:left;padding:3pt ;  font-weight: bold;">Total VAT 15%</td>
				
			</tr>

			<tr style="border:2pt solid black">
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:right;padding:3pt ; font-weight: bold;;FONT-SIZE: 15pt">إجمالي المبلغ بعد الضريبة</td>
				<td width="30%" style="border:2pt solid black;text-align:center;padding:3pt; font-weight: bold;;FONT-SIZE: 15pt" class="text-center"><span t-esc="discount_before_total" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/></td>
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:left;padding:3pt ; font-weight: bold;FONT-SIZE: 15pt"> Total Amount After Tax</td>

				
				
			</tr>
			
			<tr style="border:2pt solid black">
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:right;padding:3pt ; background-color:#dddddd;color:black; font-weight: bold;FONT-SIZE: 13pt">إجمالي المبلغ المستحق</td>
				<td width="30%" style="border:2pt solid black;text-align:center;padding:3pt ; background-color:#dddddd;color:black; font-weight: bold;FONT-SIZE: 13pt" class="text-center"><span t-esc="doc.amount_residual" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: o.currency_id}"/></td>
				<td width="35%" class="text-left arabic" style="border:2pt solid black;text-align:left;padding:3pt ; background-color:#dddddd;color:black; font-weight: bold;FONT-SIZE: 13pt">TOTAL AMOUNT DUE</td>
				
			</tr>
		</thead>
					</table>
					

					<table style="border:1pt solid grey;width:100%;color:black;color:black; margin-top:0pt;" class="table table-bordered table-sm">
						<thead>
							<tr>
								<td class="text-right arabic" width="70%" style="padding-right:12px;"><span t-esc="doc.amount_word(doc.amount_total)"/></td>
								<td class="text-right arabic" width="30%" style="font-weight: bold;background-color:#DCDCDC;">المبالغ المفوترة</td>
							</tr>
						</thead>
					</table>
				

					</div>
				</div>
			</t>
		</t>
	</template>

	<template id="report_simplified_tax_invoice">
	    <t t-call="web.html_container">
	        <t t-foreach="docs" t-as="doc">
	            <t t-call="ksa_zatca_integration.report_simplified_tax_invoice_document"/>
	        </t>
	    </t>
	</template>
</odoo>
