<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="report_e_invoicing_simplified">
        <t t-foreach="docs" t-as="doc">
            <t t-call="web.basic_layout">
                
              
                <t t-if="doc.amount_total  &lt; 0 ">
                    <t t-set="invoice_type" t-value="' Simplified Credit Note'"/>
                    <t t-set="invoice_type_ar" t-value="'اشعار دائن مبسطة'"/>
                </t>
                <t t-else="">
                    <t t-set="invoice_type" t-value="'Simplified Tax Invoice'"/>
                    <t t-set="invoice_type_ar" t-value="'فاتورة ضريبية مبسطة'"/>
                </t>

              
                <div dir="ltr">
                    <div class="pos-receipt page_block">
                        <style>
                            hr{
                            opacity: 1;
                            border-top: 1px solid rgba(0, 0, 0, 0.1);
                            color: white;
                            }
                            .data_column{
                            font-size:13px !important;
                            }
                            .label_column.arabic_label{
                            text-align:right;
                            font-size:12px !important;
                            float:right;
                            }
                            .label_column{
                            font-size:12px;
                            font-weight:bold
                            }
                            .total_table td.right_column.arabic_label, .reason_table span.right_column.arabic_label{
                            font-size:11px !important;
                            font-weight:bold;
                            }
                            .total_table td.right_column, .reason_table span.right_column{
                            text-align:right;
                            font-size:11px;
                            padding: 5px 0;
                            }
                            .reason_table span.right_column{
                            float: right;
                            }
                            .reason_table span.data_column{
                            padding: 5px 15px
                            }
                            .total_table td.left_column{
                            text-align:left;
                            font-size:11px;
                            padding: 5px 0;
                            font-weight:bold;
                            }
                            .reason_table span.left_column{
                            text-align:left;
                            font-size:11px;
                            padding: 5px 0;
                            font-weight:bold;
                            }
                            .page_block{
                            background-color: white;
                            font-family: 'Arial';
                            text-align:center;
                            font-size: 14px;
                            width: 320px;
                            padding:0;
                            margin:0;
                            }
                            #phase2qrcode{
                            text-align:center;
                            width:250px;
                            max-height:250px
                            }
                            table#invline{

                            }
                            .invline_column{
                            border-bottom:1pt dashed black;
                            vertical-align:bottom;
                            margin-bottom:5pt;
                            padding-bottom:3pt;
                            }
                            .invline_data{
                            text-align:left;
                            font-size:15px;
                            padding: 2px 0;
                            }
                        </style>
                        <style type="text/css">
                            <![CDATA[
                                @font-face {
                                    font-family: 'Arial';
                                    font-weight: bold;
                                    font-style: bold;
                                    src: url('/tax_reports/static/src/fonts/arial.ttf')
                                    format('truetype');
                                }
                                tr,td {
                                    font-family: 'Arial';
                                }
                            ]]>
                        </style>
                        <div class="pos-receipt page_block"
                             style="text-align: center;padding-bottom: 0px;display: inline-block;overflow: hidden;">
                            <t t-if="doc.company_id.parent_root_id.logo">
                                <img t-attf-src="data:image/*;base64,{{doc.company_id.parent_root_id.logo}}"
                                     style="max-height:500px; max-width:50%;display: block;margin: 0 auto;"
                                     t-options='{"widget": "image"}'/>
                                <br/>
                            </t>
                            

                            <div class="pos-receipt-contact"
                                 style="padding-top:10px;text-align: center;font-weight:bold;font-size:15px;">
                                <span>
                                    <t t-esc="invoice_type_ar"/>
                                </span>
                                <br/>
                                <span>
                                    <t t-esc="invoice_type"/>
                                </span>
                            </div>
                            <hr/>

                            <div>
                                <table width="100%">
                                    <tr>
                                        <td width="30%">
                                            <span class="label_column">
                                                <b>Invoice Ref #</b>
                                            </span>
                                        </td>
                                        <td width="40%" class="data_column">
                                            <span id="invoice_number">
                                                <t t-esc="doc.pos_reference"/>
                                            </span>
                                        </td>
                                        <td width="30%">
                                            <span class="label_column arabic_label">رقم الفاتورة</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span class="label_column">
                                                <b>Invoice Date</b>
                                            </span>
                                        </td>
                                        <td>
                                            <span  class="data_column">
                                                <t t-esc="doc.date_order"/>
                                            </span>
                                        </td>
                                        <td>
                                            <span class="label_column arabic_label">تاريخ إصدار الفاتورة</span>
                                        </td>
                                    </tr>
                                   
                                  
                                    <tr>
                                        <td>
                                            <span class="label_column">
                                                <b>Name</b>
                                            </span>
                                        </td>
                                        <td>
                                            <span class="data_column">
                                                <t t-esc="doc.company_id.name"/>
                                            </span>
                                        </td>
                                        <td>
                                            <span class="label_column arabic_label">اسم المؤسسة</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span class="label_column">
                                                <b>VAT</b>
                                            </span>
                                        </td>
                                        <td>
                                            <span class="data_column">
                                                <t t-esc="doc.company_id.parent_root_id.vat"/>
                                            </span>
                                        </td>
                                        <td>
                                            <span class="label_column arabic_label">الرقم الضريبي 
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <span class="label_column">
                                                <b>Address</b>
                                            </span>
                                        </td>
                                        <td>
                                            <span class="data_column">
                                                <t t-esc="doc.company_id.parent_root_id.building_no"/>,
                                                <t t-esc="doc.company_id.parent_root_id.street"/>
                                               
                                                    <t
                                                        t-esc="doc.company_id.parent_root_id.street2"/>,
                                                
                                                <t t-esc="doc.company_id.parent_root_id.city"/>,
                                                <t t-esc="doc.company_id.parent_root_id.state_id.name"/>,
                                                
                                            </span>
                                        </td>
                                        <td>
                                            <span class="label_column arabic_label">العنوان</span>
                                        </td>
                                    </tr>
                                  
                                </table>
                                <hr/>
                               
                                
                                <table width="100%" id="invline">
                                    <colgroup>
                                        <col width='40%'/>
                                        <col width='20%'/>
                                        <col width='20%'/>
                                        <col width='20%'/>
                                    </colgroup>
                                    <tr style="line-height: 1;">
                                        <th colspan='4' class="invline_column"
                                            style="text-align:center;border-top:1pt dashed black;border-bottom:0pt;">
                                            <span class="label_column">الوصف</span>
                                            <br/>
                                            <span class="label_column">Description</span>
                                        </th>
                                    </tr>
                                    <tr style="line-height: 1;">
                                        <th class="invline_column">
                                            <span class="label_column arabic_label"> اﻟﻤﺒﻠﻎ ﺷﺎﻣﻞ الضريبة 
                                                
                                            </span>
                                            <br/>
                                            <span class="label_column">Total Inclusive of VAT</span>
                                        </th>
                                     
                                        <th class="invline_column">
                                            <span class="label_column arabic_label">السعر</span>
                                            <br/>
                                            <span class="label_column">Price</span>
                                        </th>
                                         <th class="invline_column">

                                        </th>
                                        <th class="invline_column">
                                            <span class="label_column arabic_label">الكمية</span>
                                            <br/>
                                            <span class="label_column">Quantity</span>
                                        </th>

                                    </tr>
                                    <t t-foreach="doc.lines" t-as="line">
                                        <tr>
                                            <td colspan='4'
                                                class="invline_data"
                                                style="text-align:center;max-width:100%">
                                                <span t-esc="line.product_id.name"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="invline_data">
                                                <span t-esc="line.price_subtotal_incl"
                                                      t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                            </td>
                                          
                                            <td class="invline_data">
                                                <span t-esc="line.price_subtotal"
                                                      t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                            </td>
                                            <td class="invline_data">

                                            </td>
                                            <td class="invline_data">
                                                <t t-esc="line.qty"/>
                                            </td>

                                        
                                        </tr>
                                        <tr>
                                            <td colspan="4"
                                                style="border-bottom:1pt dashed black;vertical-align:bottom;"/>
                                        </tr>
                                    </t>
                                </table>
                                <hr></hr>
                                <table width="100%" class="total_table">
                                    <tr>
                                        <td width="30%" class="left_column">
                                            <span>Total<br/>(Excluding VAT)
                                            </span>
                                        </td>
                                        <td width="20%" class="right_column">
                                            <t t-set="amount_untaxed" t-value="doc.amount_total - doc.amount_tax"/>
                                            <span t-esc="amount_untaxed"
                                                  t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </td>
                                        <td width="50%" class="right_column arabic_label">
                                            <span>الإجمالي<br/>(غير شاملة الضريبة )
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="left_column">
                                            <span>Total VAT</span>
                                        </td>
                                        <td class="right_column">
                                            <span t-esc="doc.amount_tax"
                                                  t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </td>
                                        <td class="right_column arabic_label">
                                            <span>إجمالي ﻤﺒﻠﻎ الضريبة </span>
                                        </td>
                                    </tr>
                                   
                                    <tr>
                                        <td class="left_column">
                                            <span>Total Amount</span>
                                        </td>
                                        <td class="right_column">
                                            <span t-esc="doc.amount_total"
                                                  t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                                        </td>
                                        <td class="right_column arabic_label">
                                            <span>(إﺟﻤﺎﻟﻲ ﻘﻴﻤﺔ اﻟﻔﺎﺗﻮرة (ﺷﺎﻣﻞ الضريبة </span>
                                        </td>
                                    </tr>
                                   
                                </table>
                                <hr></hr>
                                <table style="border:2pt solid black;width:100%;color:black;margin-top:10px; color:black;" class="table table-bordered table-sm" dir="rtl">
                                    <tbody>
                                        <tr t-foreach='doc.payment_ids' t-as='pay'>
                                        <td t-if="pay.amount &lt;= 0">
                                            <td width="60%" class="text-right arabic" style="border:2pt solid black;text-align:right;padding:3pt ; background-color:#dddddd;color:black; font-weight: bold;FONT-SIZE: 15pt"> المبلغ المتبقي</td>
                                        <td width="40%" style="border:2pt solid black;text-align:center;padding:3pt ; background-color:#dddddd;color:black; font-weight: bold;FONT-SIZE: 15pt" class="text-center"><span t-field="pay.amount" /></td>
        
                                            </td>
                                            <td t-else="">
                                                <span class="text-right"><t t-esc='pay.payment_method_id.name'/></span>
                                        <td width="40%" style="border:2pt solid black;text-align:center;padding:3pt ; background-color:#dddddd;color:black; font-weight: bold;FONT-SIZE: 15pt" class="text-center"><span t-field="pay.amount" /></td>
        
                                            </td>
                                            
                                        </tr>
                                    </tbody>
                                </table>
                               
                            </div>

                        </div>
                        <!--                 Qr code-->
                        <div class="pos-receipt page page_block"
                             style="page-break-inside: avoid !important;
                             page-break-after: avoid !important;
                             page-break-before: auto !important;">
                             <img t-if="doc.get_qr_code()"
                             style="display:block;margin-left:30px;"
                             t-att-src="'/report/barcode/?barcode_type=%s&amp;value=%s&amp;width=%s&amp;height=%s'%('QR', doc.get_qr_code(), 130, 130)"/>
                        </div>
                       
                    </div>
                </div>
            </t>
        </t>
    </template>

        <record id="pos_paperformat_simplified" model="report.paperformat">
            <field name="name">POS A4 low margin</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">10</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">10</field>
            <field name="margin_right">10</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">2</field>
            <field name="dpi">90</field>
        </record>



        <record id="report_e_invoicing_siplified" model="ir.actions.report">
            <field name="name">POS PDF Receipt</field>
            <field name="model">pos.order</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">ksa_zatca_integration_pos.report_e_invoicing_simplified</field>
            <field name="report_file">ksa_zatca_integration_pos.report_e_invoicing_simplified</field>
            <field name="attachment"/>
            <field name="binding_model_id" ref="point_of_sale.model_pos_order"/>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="ksa_zatca_integration_pos.pos_paperformat_simplified"/>
        </record>


        
   
</odoo>
